## Overview
“**_Stagil navigation for jira – Menù & Themes_**" is a Jira GUI customization plugin that allows, among other things, to insert a custom image as a header and/or footer. This plugin was developed by Stagil, an independent company that is a Silver Solution Partner and focuses on designing efficient and durable plugin solutions for the Jira environment.

### Vulnerability Description
Prior to version 2.0.52 of the “_Stagil navigation for jira – Menù & Themes_", the _fileName_ parameter is vulnerable to a "_Directory Traversal_" that would allow an attacker to read files on the server knowing their path.

Directory Traversal is a vulnerability that allows an attacker to read arbitrary files on the server that is running an application. This might include application data, credentials for back-end systems, and sensitive operating system files.

### Impacts
This vulnerability allows an attacker to take files on the server and download them locally. Configuration files containing plaintext passwords can also be retrieved, as well as application logs to conduct analysis on users browsing the site.

## CVE-2023-26255

### Proof of concept (POC)
#### Reproducing Steps
First you need to have the “_Stagil navigation for jira – Menù & Themes v2.0.50”_ plugin installed, which can be downloaded from the atlassian marketplace.

You can check your "_Menù & Themes_" version in admin panel:

![2023-02-28 12_53_05-kali-linux-2022 3-vmware-amd64 - VMware Workstation](https://user-images.githubusercontent.com/126457349/221848954-06c65fb2-56c5-41fa-b842-d8fde5c600e1.jpg)

Once you have customized the Jira GUI and added a new image as the navigation bar background, you can exploit the vulnerability in question.

![2022-10-06 10_35_14-Window](https://user-images.githubusercontent.com/126457349/221830286-efd3e906-2fd8-4d8e-ae43-3660442fdcf8.jpg)

Once the image has been loaded whenever you navigate a project menu an HTTP GET request is made that invokes that image.

This request use two paramenters: “_fileName_” and “_fileMime_”, the former being vulnerable to Path Traversal since no type of check is done on the content of this parameter.

In fact, it is possible to insert a payload, consisting of the path we want to retrieve, inside "_fileName_" to get the contents of the retrieved file as the following images show:

![2022-10-06 10_50_46-Window](https://user-images.githubusercontent.com/126457349/221830399-46bf6cfc-c9b5-4887-b1ea-ef1e64498f85.jpg)

```
GET /plugins/servlet/snjCustomDesignConfig?fileName=../../../../etc/passwd&fileMime=$textMime  HTTP/1.1
Host: localhost:8080
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: image/avif,image/webp,*/*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Sec-Fetch-Dest: image
Sec-Fetch-Mode: no-cors
Sec-Fetch-Site: same-origin

```

Moreover, this request can be made even without being authenticated, in fact in the next evidence the request is made without session cookies:

![2022-10-06 10_54_35-Window](https://user-images.githubusercontent.com/126457349/221830483-091c8d56-1ea2-4763-b991-8681de8de1b5.jpg)

### Suggestions
To make the fix for this vulnerability, it is recommended to update the plugin to version 2.0.52 where this issue is no longer present.

### Discovered by
#### [Alessandro Fondacci](https://www.linkedin.com/in/alessandro-fondacci-326978a1/) of [Cybertech S.p.A.](https://www.cybertech.eu/)
